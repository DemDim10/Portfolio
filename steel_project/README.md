# Проект

## Описание и цели
Металлургическая компания решила сократить расходы на электроэнергию. Для этого она разрабатывает решение, которое сможет предсказать температуру плавления стали. 

## Данные
Данные с замерами времени, использованными материалами, температурой и другими признаками. 

## Задачи
- Загрузить данные:
    - Изучить данные
    - Сделать описание изученных данных
    - Выявить ошибки в данных
- Провести исследовательский анализ данных:
    - Посмотреть на распределение исходных данных
    - Избавиться от ошибок в данных
- Подобрать признаки, на которых будет обучаться модель:
    - Сгенерировать ряд признаков
    - Проверить признаки на мультиколлинеарность, исключить лишние
- Построить модель, которая предскажет температуру стали:
    - Сформировать обучающую, валидационную и тестовую выборки
    - Провести масштабирование признаков 
    - Выбрать несколько моделей и проверить их эффективность на тренировочной выборке с помощью показателя эффективности MAE
    - Проанализировать результаты и выбрать лучшую модель
    - Эффективность лучшей модели проверить на тестовой выборке
- Написать отчет по выполненой работе    

## Полученные выводы
#### Решаемая задача:

Исследовательской задачей было построение модели, которая предскажет температуру стали на этапе плавления. 

#### Описание решения:

Для успешного выполнения важным этапом были подготовка и обработка исходных данных. На этом этапе данные были загружены и подробно изучены , стало понятно, какие данные следует удалить из таблицы, также выявлены ошибки. Был проведен исследовательский анализ, с помощью которого определены выбивающиеся значения, а также получена информация о распределении данных. Ошибки обработаны без искажения исходного датафрейма. Сфоримирована таблица с признаками, определен целевой. Все имеющиеся признаки проверили на мультиколлинеарность.

Далее перешли к подготовке к обучению моделей. В этом пункте сформировали датасеты с признаками и целевым признаком, разбили данные на обучающую и тестовую выборки, произвели масштабирование. Сформировали отдельные датасеты, взяв во внимание результаты проверки на мультиколлинеарность. В обучении использовали модели Линейной регрессии, Случайного леса и CatBoost - к ним созданы функции, выводящие значения метрики MAE без подбора параметров. Далее подобрали параметры через RSCV и записали результаты в переменные. Построили графики по полученным данным и сравнили MAE и время каждой модели друг с другом. Лучшей оказался Случайный лес. Для Случайного леса построили график и таблицу зависимости предсказания целевого признака от других признаков. 
Затем мы проверили модель на тестовой выборке и получили итоговый результат MAE. 

#### Результат решения:

* Модель: RandomForestRegressor;
* Параметры: warm_start = True, random_state = 311022, n_jobs = -1, n_estimators = 90, max_features = 'auto', max_depth = 8, ccp_alpha = 0.01, oob_score = False, bootstrap = True;
* Метрика MAE = 6.783

#### Факторы модели:

Топ-10 признаков, повлиявших на предсказание целевого:

* 1) first_temp, коэффицент джини - 0.164668
* 2)	wire 1, коэффицент джини - 0.137706
* 3) 	active_power, коэффицент джини - 0.129834
* 4)	gas, коэффицент джини - 0.077806
* 5)	bulk 15, коэффицент джини - 0.075802
* 6)	bulk 12, коэффицент джини - 0.069490
* 7)	bulk 14, коэффицент джини - 0.066458
* 8)	reactive_power, коэффицент джини - 0.053062
* 9)	wire 2, коэффицент джини - 0.045460
* 10) bulk 6, коэффицент джини - 0.044493

Также на результат модели повлияли провильная подготовка данных и их масштабирование. 

Таким образом мы решили поставленную задачу и получили не только моедль с хорошими показателями но и важную для понимания производственных процессов информацию. Результаты данного исследования бизнес может использовать в оптимизации производственны расходов.

## Используемые инструменты
*python*, *pandas*, *markdown*, *termcolor*, *matplotlib*, *seaborn*, *NumPy*, *SkLearn*, *Catboost*

## Ключевые слова
регрессия, разработка бизнес-модели, подбор гиперпараметров, выбор модели МО
